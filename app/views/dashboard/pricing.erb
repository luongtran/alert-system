<script>
    $(document).ready(function () {
        $('#label-leader').text("Plan and Pricing");
//        alert($('#current_role').val());
        $('.pricing-box#planbox' + $('#current_role').val()).remove();
    });
</script>
<script>
    $(function () {
        $('#downgrade-to-free-plan-btn').click(function () {
//            alert('alert msg');
            $('#plan-options').removeAttr();
        });

    });
</script>

<br/>
<h4>Need to update billing
  information? <%= link_to 'Update here', users_edit_billing_path, :class => 'btn btn-primary' %></h4>
<br/>
<hr class="divider">

<h4>Your currently subscription plan: <%= @current_user_role_name.titleize %></h4>
<br/>
<h4>Change plan?</h4>
<%= hidden_field_tag :current_role, @current_user_role_id, :id => "current_role" %>
<div class="row span10 plans">
  <div class="pricing-box span4" id="planbox1">
    <div class="pricing-padding">
      <h2>Free </h2>
      <ul>
        <li>$0/month</li>
        <li>Encryption : Standard</li>
        <li>Limited : 1 Package</li>
      </ul>
      <br/>
      <%
         label = 'Downgrade'
         message = "Note: Free plan limited only 1 package, if you downgrade to free plan, some older packages may be deleted \n\n  Are you sure to continue?"
      %>
      <%= link_to label, update_plan_path(:role_ids => Role.find_by_name('free').id), :class => 'btn btn-danger', :id => "downgrade-to-free-plan-btn", :data => {:confirm => message}, :method => :put %>
    </div>
  </div>
  <div class="pricing-box span4" id="planbox2">
    <div class="pricing-padding">
      <h2>Small </h2>
      <ul>
        <li>$5/month</li>
        <li>Encryption : Standard</li>
        <li>Limited : 3 Packages</li>
      </ul>
      <br/>
      <%
         label = ""
         message = ""
         if @current_user_role_id > Role.find_by_name('small').id
           label = 'Downgrade'
           message = "Note: Small plan limited 3 packages, if you downgrade to this plan, some older packages may be deleted !\n\n  Are you sure to continue?"
         else
           label = 'Upgrade'
           message = "Small Plan : with $5/month\n Are you sure ?"
         end
      %>
      <%= link_to label, update_plan_path(:role_ids => Role.find_by_name('small').id), :class => 'btn btn-primary', :method => :put, :data => {:confirm => message} %>


    </div>
  </div>
  <div class="pricing-box span4" id="planbox3">
    <div class="pricing-padding">
      <h2>Medium </h2>
      <ul>
        <li>$10/month</li>
        <li>Encryption : Standard</li>
        <li>Limited : 10 Packages</li>
      </ul>
      <br/>
      <%
         label = ""
         message = ""
         if @current_user_role_id > Role.find_by_name('medium').id
           label = 'Downgrade'
           message = "Note: Medium plan limited 10 packages, some older packages may be deleted if you downgrade to this plan !\n\n Are you sure to continue?"
         else
           label = 'Upgrade'
           message = "Medium Plan with $10/month\n Are you sure to continue?"
         end
      %>
      <%= link_to label, update_plan_path(:role_ids => Role.find_by_name('medium').id), :class => 'btn btn-primary', :method => :put, :data => {:confirm => message} %>
    </div>
  </div>
  <div class="pricing-box span4" id="planbox4">
    <div class="pricing-padding">
      <h2>Large </h2>
      <ul>
        <li>$15/month</li>
        <li>Encryption : Custom key</li>
        <li>Limited : 30 Packages</li>
      </ul>
      <br/>
      <%
         label = 'Upgrade'
         message = "Large Plan with $15/month\n Are you sure to continue?"
      %>
      <%= link_to label, update_plan_path(:role_ids => Role.find_by_name('large').id), :class => 'btn btn-primary', :method => :put, :data => {:confirm => message} %>
    </div>
  </div>
</div>

<% if false %>
    <h3>Subscription Plan</h3>

    <p>
      <%= current_user.roles.first.name.titleize %>
      <%= link_to "Change plan", "#plan-options", class: "btn btn-primary", data: {toggle: "modal"} %>
    </p>
<% end %>







